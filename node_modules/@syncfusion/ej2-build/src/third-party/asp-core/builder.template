using System;
using System.IO;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Linq.Expressions;
using System.Text;
#if !EJ2_DNX
using Microsoft.AspNetCore.Html;
#else
using System.Web;
#endif

namespace Syncfusion.EJ2.{{namespace}}
{
    public partial class {{builderClassName}} : ControlBuilder {{tClass}}
    {
        {{templateCollections}}
        public {{className}} model = new {{className}}();

        internal string inputText;

        internal string inputType = "{{tagType}}";

        public {{className}}Builder() { }

        public {{className}}Builder({{className}} model)
        {
            this.model = model;
        }

        {{builderProperties}}

        public HtmlString Render()
        {
            StringBuilder tagName = model.GetHtmlAttrString((IDictionary<string, object>)this.model.HtmlAttributes);
            {{htmlString}}
#if EJ2_DNX
            if (this.Context == null)
            {
                this.Context = new HttpContextWrapper(HttpContext.Current);
                if (!this.Context.Items.Contains("ejsscriptManager"))
                {
                    this.Context.Items.Add("ejsscriptManager", new EJSScriptRenderContext());
                }

            }
            (this.Context.Items["ejsscriptManager"] as EJSScriptRenderContext).Add(model.GetScriptString());
#else
            ScriptRenderer.Add(model.GetScriptString(), this.Context);
#endif
            var contextString = (inputText != null && inputText.Length > 0) ? inputText :"{{defaultTag}}";
            return new HtmlString(contextString);
        }

        public IDictionary<string, object> HtmlAttr
        {
            get;
            set;
        }

        public override TextWriter Output
        {
            get;
            set;
        }

        public string ID
        {
            get { return model.Id; }
            set { model.Id = value; }
        }
    }
}
